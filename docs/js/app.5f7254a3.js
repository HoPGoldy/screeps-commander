(function(t){function e(e){for(var n,o,c=e[0],r=e[1],l=e[2],d=0,v=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&v.push(i[o][0]),i[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);u&&u(e);while(v.length)v.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,c=1;c<a.length;c++){var r=a[c];0!==i[r]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=r;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"0247":function(t,e,a){"use strict";var n=a("c544"),i=a.n(n);i.a},"38e1":function(t,e,a){},"3db9":function(t,e,a){"use strict";var n=a("5f52"),i=a.n(n);i.a},"5f52":function(t,e,a){},"5fce":function(t,e,a){"use strict";var n=a("a06c"),i=a.n(n);i.a},"85b0":function(t,e,a){},a06c:function(t,e,a){},c544:function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=a("bc3a"),s=a.n(i),o=a("4328"),c=a.n(o),r={screeps:"https://cors-anywhere.herokuapp.com/https://screeps.com"};s.a.interceptors.request.use((function(t){return t}));var l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"screeps",i=/http/.test(t)?t:r[n]+t;return s()({url:i,params:e,method:"get",headers:a})},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"screeps";e=c.a.stringify(e);var i=/http/.test(t)?t:r[n]+t;return s()({url:i,data:e,method:"post",headers:a})},d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("div",[a("v-app-bar",{attrs:{color:"blue accent-3",dark:"",app:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.sideDrawerVisiable=!t.sideDrawerVisiable}}}),a("v-toolbar-title",[t._v("Screeps Commander")])],1)],1),a("navigation",{attrs:{show:t.sideDrawerVisiable},on:{"on-close":function(e){t.sideDrawerVisiable=!1}}}),a("v-content",{attrs:{app:""}},[a("router-view")],1)],1)},v=[],m=a("d4ec"),b=a("99de"),p=a("7e84"),h=a("262e"),f=a("9ab4"),k=a("60a3"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav-container"},[a("v-navigation-drawer",{attrs:{app:"",temporary:""},model:{value:t.sidebarDrawerVisiable,callback:function(e){t.sidebarDrawerVisiable=e},expression:"sidebarDrawerVisiable"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"title"},[t._v("Screeps Commander")]),a("v-list-item-subtitle",[t._v("@hopgoldy")])],1)],1),a("v-divider"),a("v-list",{attrs:{dense:"",nav:""}},t._l(t.items,(function(e){return a("v-list-item",{key:e.title,attrs:{link:""},on:{click:function(a){return t.onClickSidebar(e.comp,e.persistent)}}},[a("v-list-item-icon",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.title))])],1)],1)})),1)],1),a("v-dialog",{attrs:{eager:"",persistent:t.sidebarPersistent},model:{value:t.sidebarVisiable,callback:function(e){t.sidebarVisiable=e},expression:"sidebarVisiable"}},[a(t.activeSidebar,{tag:"component",on:{"on-finish":t.onSidebarFinish}})],1)],1)},y=[],C=a("5530"),O=a("bee2"),j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[a("span",[t._v(t._s(t.editMode?"编辑按钮":"添加新按钮"))]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHelp=!0}}},[a("v-icon",[t._v("mdi-help-circle-outline")])],1)],1),a("v-card-text",[a("v-text-field",{staticClass:"mb-4",attrs:{label:"名称","hide-details":"",clearable:""},model:{value:t.commandInfo.title,callback:function(e){t.$set(t.commandInfo,"title",e)},expression:"commandInfo.title"}}),a("v-text-field",{staticClass:"mb-4",attrs:{label:"目标 shard（置空以使用全局 shard）","hide-details":"",clearable:""},model:{value:t.commandInfo.shard,callback:function(e){t.$set(t.commandInfo,"shard",e)},expression:"commandInfo.shard"}}),a("v-textarea",{staticClass:"mb-4",attrs:{label:"命令","hide-details":"","auto-grow":"",clearable:"",rows:"1"},model:{value:t.commandInfo.body,callback:function(e){t.$set(t.commandInfo,"body",e)},expression:"commandInfo.body"}}),a("div",{staticClass:"mt-5"},[t._l(t.params,(function(e,n){return[a("div",{staticClass:"mb-2 d-flex justify-space-between"},[a("v-btn",{staticClass:"mr-2",attrs:{color:"error",small:"",icon:""},on:{click:function(e){return t.removeParam(n)}}},[a("v-icon",[t._v("mdi-close-circle")])],1),a("v-btn",{staticClass:"flex-grow-1",attrs:{small:""},on:{click:function(e){return t.editParam(n)}}},[a("span",{staticClass:"d-inline-block text-truncate text-no-wrap"},[t._v(t._s(e.label))]),a("v-spacer"),a("span",[t._v(t._s(e.match))])],1)],1)]})),a("v-btn",{attrs:{block:"",small:""},on:{click:t.addNewParam}},[t._v("添加参数")])],2)],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{depressed:"",width:"100"},on:{click:function(e){t.showCancelConfirm=!0}}},[t._v(t._s(t.editMode?"返回":"放弃"))]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",width:"100",depressed:""},on:{click:t.saveNewButton}},[t._v(t._s(t.editMode?"保存":"创建"))])],1),a("v-dialog",{model:{value:t.showCancelConfirm,callback:function(e){t.showCancelConfirm=e},expression:"showCancelConfirm"}},[a("v-card",[a("v-card-text",{staticClass:"pa-4"},[a("div",{staticClass:"text-center mb-4"},[t._v("确认放弃编辑？"+t._s(t.editMode?"新修改的内容不会被保存":"该按钮的所有配置都将被清空。"))]),a("v-btn",{attrs:{color:"error",block:""},on:{click:t.cancel}},[t._v("确认")])],1)],1)],1),a("button-help",{attrs:{show:t.showHelp},on:{"on-close":function(e){t.showHelp=!1}}}),a("param-config",{attrs:{show:t.showParamConfig},on:{"on-cancel":function(e){t.showParamConfig=!1},"on-confirm":t.updateParam},model:{value:t.editParamData,callback:function(e){t.editParamData=e},expression:"editParamData"}})],1)},w=[],V=(a("caad"),a("d81d"),a("a434"),a("ac1f"),a("2532"),a("466d"),"screepsCommandStorage"),x="shard3",_=[{title:"查看 tick 时间",shard:"shard3",body:"Game.time",param:[]},{title:"查看 Creep 数量",shard:"shard3",body:"Object.keys(Game.creeps).length",param:[]},{title:"查看指定房间 RCL",shard:"shard3",body:"Game.rooms.$0.controller.level",param:[{label:"查看房间",default:"W1N1",match:"$0"}]}],S=function(t){function e(){return Object(m["a"])(this,e),Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments))}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"init",value:function(){var t=localStorage.getItem(V);t?this.dataBase=JSON.parse(t):(this.dataBase={shard:x,commands:_},this.save())}},{key:"get",value:function(){return this.dataBase}},{key:"getOrigin",value:function(){var t=localStorage.getItem(V);return"string"===typeof t?t:""}},{key:"saveOrigin",value:function(t){localStorage.setItem(V,t),this.init()}},{key:"addNewCommand",value:function(t){this.dataBase.commands.push(t),this.save()}},{key:"updateCommand",value:function(t,e){t>=this.dataBase.commands.length||(this.dataBase.commands[t]=e,this.save())}},{key:"removeCommand",value:function(t){this.dataBase.commands.splice(t,1),this.save()}},{key:"setShard",value:function(t){this.dataBase.shard=t,this.save()}},{key:"setToken",value:function(t){this.dataBase||this.init(),this.dataBase.token=t,this.save()}},{key:"save",value:function(){localStorage.setItem(V,JSON.stringify(this.dataBase))}},{key:"exist",get:function(){var t=localStorage.getItem(V);return"string"===typeof t}}]),e}(k["e"]);S=Object(f["a"])([k["a"]],S);var T=new S,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{on:{"click:outside":t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-text",{staticClass:"pa-2"},t._l(t.info,(function(e,n){return a("v-list-item",{key:n},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v(t._s(e.title))]),a("div",{staticClass:"pt-1 lh"},[t._v(t._s(e.content))]),e.code?a("code",{staticClass:"mt-2 pa-1"},[t._v(t._s(e.code))]):t._e()],1)],1)})),1)],1)],1)},L=[],P=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.info=[{title:"命令",content:"命令是点击该按钮时发送到 screeps 的代码主体。支持任何可以在游戏控制台中执行的表达式。如下：",code:"Object.key(Game.creeps).length"},{title:"参数",content:"为了提高功能性，你可以通过新建多个参数来实现诸如 ”从某房发送某资源到某房“ 的操作。参数会在点击按钮时通过弹出框进行收集。"},{title:"占位符",content:"占位符代表着参数将要插入到的命令位置，参数在新建时会自动分配以 $ 开头的占位符。如果在命令中没有找到对应的占位符，该参数将被抛弃。占位符允许在命令中出现多次。",code:"Game.rooms.$1.controller.level"}],t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"onClose",value:function(){}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])({required:!0})],P.prototype,"show",void 0),Object(f["a"])([Object(k["b"])("on-close")],P.prototype,"onClose",null),P=Object(f["a"])([k["a"]],P);var B=P,D=B,$=(a("3db9"),a("2877")),N=a("6544"),E=a.n(N),M=a("b0af"),A=a("99d9"),F=a("169a"),W=a("da13"),J=a("5d23"),q=Object($["a"])(D,I,L,!1,null,"694f7ab2",null),G=q.exports;E()(q,{VCard:M["a"],VCardText:A["b"],VDialog:F["a"],VListItem:W["a"],VListItemContent:J["a"],VListItemTitle:J["c"]});var R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("参数配置")]),a("v-card-text",[a("v-text-field",{attrs:{label:"占位符","hide-details":"",disabled:""},model:{value:t.value.match,callback:function(e){t.$set(t.value,"match",e)},expression:"value.match"}}),a("v-text-field",{staticClass:"mt-4",attrs:{rules:t.rules,counter:t.inputLimit,label:"标签",clearable:""},model:{value:t.value.label,callback:function(e){t.$set(t.value,"label",e)},expression:"value.label"}}),a("v-text-field",{attrs:{label:"默认值","hide-details":"",clearable:""},model:{value:t.value.default,callback:function(e){t.$set(t.value,"default",e)},expression:"value.default"}})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{on:{click:t.cancel}},[t._v("取消")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",dark:""},on:{click:t.confirm}},[t._v("确定")])],1)],1)],1)},H=[],U=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.inputLimit=20,t.rules=[function(e){return!e||e.length<=t.inputLimit||"超过字数限制"}],t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"confirm",value:function(){return""===this.value.label&&(this.value.label="未命名参数"),this.value.label.length>this.inputLimit&&(this.value.label=this.value.label.substring(0,this.inputLimit)),this.value}},{key:"cancel",value:function(){}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])({required:!0,default:{match:"",default:"",label:""}})],U.prototype,"value",void 0),Object(f["a"])([Object(k["d"])({required:!0})],U.prototype,"show",void 0),Object(f["a"])([Object(k["b"])("on-confirm")],U.prototype,"confirm",null),Object(f["a"])([Object(k["b"])("on-cancel")],U.prototype,"cancel",null),U=Object(f["a"])([k["a"]],U);var X=U,z=X,K=a("8336"),Q=a("ce7e"),Y=a("2fa4"),Z=a("8654"),tt=Object($["a"])(z,R,H,!1,null,null,null),et=tt.exports;E()(tt,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardText:A["b"],VCardTitle:A["c"],VDialog:F["a"],VDivider:Q["a"],VSpacer:Y["a"],VTextField:Z["a"]});var at={ButtonHelp:G,ParamConfig:et},nt=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.editMode=!1,t.params=[],t.showCancelConfirm=!1,t.showHelp=!1,t.showParamConfig=!1,t.editParamIndex=0,t.editParamData={label:"",default:"",match:""},t.commandInfo={title:"新按钮",shard:x,body:"Game.time"},t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"switchToEditMode",value:function(t){if(!(this.editIndex<0)){this.editMode=!0;var e=JSON.parse(JSON.stringify(T.get().commands[t]));this.params=e.param,this.commandInfo=e}}},{key:"addNewParam",value:function(){var t=this.params.length,e=this.params.map((function(t){return t.match}));while(e.includes("$".concat(t)))t+=1;this.params.push({label:"参数".concat(t),default:"",match:"$".concat(t)})}},{key:"removeParam",value:function(t){this.params.splice(t,1)}},{key:"editParam",value:function(t){this.editParamIndex=t,this.editParamData=this.params[t],this.showParamConfig=!0}},{key:"updateParam",value:function(t){this.showParamConfig=!1,this.params[this.editParamIndex]=t}},{key:"reset",value:function(){this.params=[],this.commandInfo={title:"新按钮",shard:x,body:"Game.time"}}},{key:"saveNewButton",value:function(){var t=this.editMode?"保存成功":"添加成功，点击右下角按钮查看",e=JSON.parse(JSON.stringify(Object(C["a"])({},this.commandInfo,{param:this.params})));return this.editMode?T.updateCommand(this.editIndex,e):T.addNewCommand(e),this.reset(),{show:!0,color:"success",content:t}}},{key:"cancel",value:function(){return this.reset(),{show:!1}}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])()],nt.prototype,"editIndex",void 0),Object(f["a"])([Object(k["f"])("editIndex")],nt.prototype,"switchToEditMode",null),Object(f["a"])([Object(k["b"])("on-finish")],nt.prototype,"saveNewButton",null),Object(f["a"])([Object(k["b"])("on-finish")],nt.prototype,"cancel",null),nt=Object(f["a"])([Object(k["a"])({components:Object(C["a"])({},at)})],nt);var it=nt,st=it,ot=a("132d"),ct=a("a844"),rt=Object($["a"])(st,j,w,!1,null,null,null),lt=rt.exports;E()(rt,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardText:A["b"],VCardTitle:A["c"],VDialog:F["a"],VDivider:Q["a"],VIcon:ot["a"],VSpacer:Y["a"],VTextField:Z["a"],VTextarea:ct["a"]});var ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("按钮配置")]),a("v-list",t._l(t.commands,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("v-list-item",[a("span",{staticClass:"d-inline-block text-truncate text-no-wrap"},[t._v(t._s(e.title))]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.editButton(n)}}},[a("v-icon",[t._v("mdi-pencil-plus")])],1),a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.buttonRemovePrepare(n)}}},[a("v-icon",{attrs:{color:"error"}},[t._v("mdi-delete")])],1)],1),n!=t.commands.length-1?a("v-divider"):t._e()],1)})),0),0===t.commands.length?a("div",{staticClass:"d-flex justify-center align-center pb-4 text--secondary"},[a("v-icon",{staticClass:"mr-1",attrs:{color:"grey lighten-1"}},[t._v("mdi-emoticon-sad")]),a("div",[t._v("暂无按钮")])],1):t._e(),a("v-dialog",{model:{value:t.removeConfirmVisiable,callback:function(e){t.removeConfirmVisiable=e},expression:"removeConfirmVisiable"}},[a("v-card",[a("v-card-text",{staticClass:"pa-4"},[a("div",{staticClass:"text-center mb-4"},[t._v("确认删除？该按钮的所有配置都将被清空。")]),a("v-btn",{attrs:{color:"error",block:""},on:{click:t.removeButton}},[t._v("确认")])],1)],1)],1),a("v-dialog",{attrs:{eager:"",persistent:""},model:{value:t.editVisiable,callback:function(e){t.editVisiable=e},expression:"editVisiable"}},[a("button-edit",{attrs:{"edit-index":t.editIndex},on:{"on-finish":t.onEditFinish}})],1)],1)},dt=[],vt=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.removeConfirmVisiable=!1,t.waitRemoveButtonIndex=0,t.commands=T.get().commands,t.editVisiable=!1,t.editIndex=-1,t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"buttonRemovePrepare",value:function(t){this.waitRemoveButtonIndex=t,this.removeConfirmVisiable=!0}},{key:"removeButton",value:function(){this.removeConfirmVisiable=!1,T.removeCommand(this.waitRemoveButtonIndex)}},{key:"editButton",value:function(t){this.editVisiable=!0,this.editIndex=t}},{key:"onEditFinish",value:function(){this.editIndex=-1,this.editVisiable=!1}}]),e}(k["e"]);vt=Object(f["a"])([Object(k["a"])({components:{ButtonEdit:lt}})],vt);var mt=vt,bt=mt,pt=a("8860"),ht=Object($["a"])(bt,ut,dt,!1,null,"57d0477f",null),ft=ht.exports;E()(ht,{VBtn:K["a"],VCard:M["a"],VCardText:A["b"],VCardTitle:A["c"],VDialog:F["a"],VDivider:Q["a"],VIcon:ot["a"],VList:pt["a"],VListItem:W["a"],VSpacer:Y["a"]});var kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[a("span",[t._v("设置全局 shard")])]),a("v-card-text",{staticClass:"pt-0"},[a("v-text-field",{attrs:{label:"shard 名称","hide-details":""},model:{value:t.shard,callback:function(e){t.shard=e},expression:"shard"}}),a("div",{staticClass:"mt-5 caption grey--text text--darken-1"},[t._v("用于确定本应用控制台命令发送到的 shard（默认为 shard3）。命令按钮中配置的 shard 值会覆盖该选项。")])],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{depressed:""},on:{click:t.cancel}},[t._v("取消")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",depressed:""},on:{click:t.confirm}},[t._v("确认")])],1)],1)},gt=[],yt=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.shard="",t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"confirm",value:function(){""===this.shard&&(this.shard=x),T.setShard(this.shard),this.finish()}},{key:"finish",value:function(){return{show:!0,content:"已将控制台输入重定向到 ".concat(this.shard),color:"success"}}},{key:"cancel",value:function(){return{show:!1}}},{key:"mounted",value:function(){this.shard=T.get().shard}}]),e}(k["e"]);Object(f["a"])([Object(k["b"])("on-finish")],yt.prototype,"finish",null),Object(f["a"])([Object(k["b"])("on-finish")],yt.prototype,"cancel",null),yt=Object(f["a"])([k["a"]],yt);var Ct=yt,Ot=Ct,jt=Object($["a"])(Ot,kt,gt,!1,null,"2b7aa70e",null),wt=jt.exports;E()(jt,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardText:A["b"],VCardTitle:A["c"],VDivider:Q["a"],VSpacer:Y["a"],VTextField:Z["a"]});var Vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"py-5 text-center"},[a("div",{staticClass:"subtitle-1"},[t._v(t._s(t.introduce))]),a("v-text-field",{attrs:{label:"粘贴至此处","hide-details":"",clearable:""},model:{value:t.newToken,callback:function(e){t.newToken=e},expression:"newToken"}})],1),a("v-card-actions",[t.statsConfirm?a("v-btn",{on:{click:t.cancelLoad}},[t._v("取消")]):t._e(),t.statsConfirm?a("v-spacer"):t._e(),a("v-btn",{attrs:{block:!t.statsConfirm,color:t.btnColor,dark:""},on:{click:t.confirmImport}},[t._v(t._s(t.btnText))])],1)],1)},xt=[],_t=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.newToken="",t.statsConfirm=!1,t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"confirmImport",value:function(){this.statsConfirm?this.importToken():this.statsConfirm=!0}},{key:"cancelLoad",value:function(){this.statsConfirm=!1}},{key:"importToken",value:function(){T.setToken(this.newToken),this.statsConfirm=!1,this.finish(),this.newToken=""}},{key:"finish",value:function(){return{show:!0,content:this.newToken?"导入成功, 已启用免登陆":"移除成功，免登陆已关闭",color:"success"}}},{key:"introduce",get:function(){return this.statsConfirm?"接下来的操作会覆盖你的现存 Token，是否继续？":"将 AuthToken 粘贴至此处来更新您的配置，置空来移除 token"}},{key:"btnText",get:function(){return this.statsConfirm?"我了解，确认":"应用"}},{key:"btnColor",get:function(){return this.statsConfirm?"error":"primary"}}]),e}(k["e"]);Object(f["a"])([Object(k["b"])("on-finish")],_t.prototype,"finish",null),_t=Object(f["a"])([k["a"]],_t);var St=_t,Tt=St,It=Object($["a"])(Tt,Vt,xt,!1,null,null,null),Lt=It.exports;E()(It,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardText:A["b"],VSpacer:Y["a"],VTextField:Z["a"]});var Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"py-5 text-center"},[a("div",{staticClass:"subtitle-1"},[t._v(t._s(t.introduce))]),a("v-text-field",{attrs:{label:"粘贴至此处","hide-details":"",clearable:""},model:{value:t.newConfig,callback:function(e){t.newConfig=e},expression:"newConfig"}})],1),a("v-card-actions",[t.statsConfirm?a("v-btn",{on:{click:t.cancelLoad}},[t._v("取消")]):t._e(),t.statsConfirm?a("v-spacer"):t._e(),a("v-btn",{attrs:{block:!t.statsConfirm,color:t.btnColor,dark:""},on:{click:t.confirmLoad}},[t._v(t._s(t.btnText))])],1)],1)},Bt=[],Dt=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.newConfig="",t.statsConfirm=!1,t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"confirmLoad",value:function(){""!==this.newConfig&&(this.statsConfirm?this.loadConfig():this.statsConfirm=!0)}},{key:"cancelLoad",value:function(){this.statsConfirm=!1}},{key:"loadConfig",value:function(){T.saveOrigin(this.newConfig),this.statsConfirm=!1,this.newConfig="",this.finish()}},{key:"finish",value:function(){return{show:!0,content:"导入成功",color:"success"}}},{key:"introduce",get:function(){return this.statsConfirm?"接下来的操作会覆盖你的现存配置项，是否继续？":"将配置项粘贴到下方并点击”应用“按钮来导入配置项。"}},{key:"btnText",get:function(){return this.statsConfirm?"我了解，确认":"应用"}},{key:"btnColor",get:function(){return this.statsConfirm?"error":"primary"}}]),e}(k["e"]);Object(f["a"])([Object(k["b"])("on-finish")],Dt.prototype,"finish",null),Dt=Object(f["a"])([k["a"]],Dt);var $t=Dt,Nt=$t,Et=Object($["a"])(Nt,Pt,Bt,!1,null,null,null),Mt=Et.exports;E()(Et,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardText:A["b"],VSpacer:Y["a"],VTextField:Z["a"]});var At=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"text-center"},[a("div",{staticClass:"subtitle-1 pt-5"},[t._v("该配置项可能会包含您的 token，请不要分享给其他人。")]),a("v-text-field",{staticClass:"mb-4",attrs:{"hide-details":""},model:{value:t.copyContent,callback:function(e){t.copyContent=e},expression:"copyContent"}}),a("v-btn",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.copyContent,expression:"copyContent",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{block:"",color:"primary",dark:""}},[t._v("导出配置项")])],1)],1)},Ft=[],Wt=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.copyContent="",t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"onCopy",value:function(){return{show:!0,content:"已导出到剪切板",color:"success"}}},{key:"onError",value:function(){return{show:!0,content:"异常，可能已经导出完成，请粘贴确认",color:"error"}}},{key:"mounted",value:function(){this.copyContent=T.getOrigin()}}]),e}(k["e"]);Object(f["a"])([Object(k["b"])("on-finish")],Wt.prototype,"onCopy",null),Object(f["a"])([Object(k["b"])("on-finish")],Wt.prototype,"onError",null),Wt=Object(f["a"])([k["a"]],Wt);var Jt=Wt,qt=Jt,Gt=Object($["a"])(qt,At,Ft,!1,null,"7c142734",null),Rt=Gt.exports;E()(Gt,{VBtn:K["a"],VCard:M["a"],VCardText:A["b"],VTextField:Z["a"]});var Ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"pa-2"},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("作者")]),a("div",{staticClass:"pt-1"},[a("span",[t._v("本应用由")]),a("a",{on:{click:function(e){return t.openPage(t.homePage)}}},[t._v(" HoPGoldy")]),a("span",[t._v(" 制作并开源。")])])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("数据")]),a("div",{staticClass:"pt-1"},[t._v("本应用所有数据均保存在本地，自动或手动清除浏览器缓存将可能导致数据丢失（确保浏览器已退出无痕模式），请妥善使用导出 / 导入功能。")])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("隐私")]),a("div",{staticClass:"pt-1"},[t._v("本应用不会保存您的 Screeps 账号密码，所以在退出应用后您可能需要重新登录。")])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("开源")]),a("div",{staticClass:"pt-1"},[a("span",[t._v("本应用代码已开源至 github。点击")]),a("a",{on:{click:function(e){return t.openPage(t.githubUrl)}}},[t._v(" 此处")]),a("span",[t._v(" 来访问本项目源码。")])])],1)],1)],1)],1)},Ut=[],Xt=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.githubUrl="https://github.com/HoPGoldy/screeps-commander",t.homePage="https://hopgoldy.github.io/",t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"openPage",value:function(t){window.open(t)}}]),e}(k["e"]);Xt=Object(f["a"])([k["a"]],Xt);var zt=Xt,Kt=zt,Qt=Object($["a"])(Kt,Ht,Ut,!1,null,null,null),Yt=Qt.exports;E()(Qt,{VCard:M["a"],VCardText:A["b"],VListItem:W["a"],VListItemContent:J["a"],VListItemTitle:J["c"]});var Zt={ButtonEdit:lt,ButtonConfig:ft,ShardSetter:wt,TokenSetter:Lt,LoadConfig:Mt,SaveConfig:Rt,About:Yt},te=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.items=[{title:"创建新按钮",comp:"button-edit",icon:"mdi-plus-box-multiple",persistent:!0},{title:"配置按钮",comp:"button-config",icon:"mdi-cursor-default-click",persistent:!1},{title:"设置 shard",comp:"shard-setter",icon:"mdi-server",persistent:!1},{title:"管理 AuthToken",comp:"token-setter",icon:"mdi-alpha-t-box",persistent:!1},{title:"导出配置项",comp:"save-config",icon:"mdi-download-multiple",persistent:!1},{title:"导入配置项",comp:"load-config",icon:"mdi-upload-multiple",persistent:!1},{title:"关于",comp:"about",icon:"mdi-help-box",persistent:!1}],t.show=!1,t.sidebarVisiable=!1,t.sidebarDrawerVisiable=!1,t.sidebarPersistent=!1,t.activeSidebar="save-config",t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"syncShow",value:function(t){this.sidebarDrawerVisiable=t}},{key:"emitCloseEvent",value:function(t){t||this.closeDrawer()}},{key:"onClickSidebar",value:function(t,e){this.sidebarVisiable=!0,this.sidebarDrawerVisiable=!1,this.activeSidebar=t,this.sidebarPersistent=e}},{key:"onSidebarFinish",value:function(t){this.sidebarVisiable=!1,t.show&&this.$toast(t.content||"设置成功",{color:t.color})}},{key:"closeDrawer",value:function(){}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])({required:!0})],te.prototype,"show",void 0),Object(f["a"])([Object(k["f"])("show")],te.prototype,"syncShow",null),Object(f["a"])([Object(k["f"])("sidebarDrawerVisiable")],te.prototype,"emitCloseEvent",null),Object(f["a"])([Object(k["b"])("on-close")],te.prototype,"closeDrawer",null),te=Object(f["a"])([Object(k["a"])({components:Object(C["a"])({},Zt)})],te);var ee=te,ae=ee,ne=a("34c3"),ie=a("f774"),se=Object($["a"])(ae,g,y,!1,null,"3b5e0e00",null),oe=se.exports;E()(se,{VDialog:F["a"],VDivider:Q["a"],VIcon:ot["a"],VList:pt["a"],VListItem:W["a"],VListItemContent:J["a"],VListItemIcon:ne["a"],VListItemSubtitle:J["b"],VListItemTitle:J["c"],VNavigationDrawer:ie["a"]});var ce=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.sideDrawerVisiable=!1,t}return Object(h["a"])(e,t),e}(k["e"]);ce=Object(f["a"])([Object(k["a"])({components:{Navigation:oe}})],ce);var re=ce,le=re,ue=(a("5fce"),a("7496")),de=a("40dc"),ve=a("5bc1"),me=a("a75b"),be=a("2a7f"),pe=Object($["a"])(le,d,v,!1,null,"becac1e4",null),he=pe.exports;E()(pe,{VApp:ue["a"],VAppBar:de["a"],VAppBarNavIcon:ve["a"],VContent:me["a"],VToolbarTitle:be["a"]});var fe=a("8c4f"),ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"console-container"},[a("v-list",{attrs:{dense:""}},[a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.messageList,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("console-item",{attrs:{content:e.content,icon:e.icon,loading:e.loading},on:{"on-icon-click":t.pasteMessage,"on-item-click":function(a){return t.onItemClick(e)}}})],1)})),0),a("div",{directives:[{name:"intersect",rawName:"v-intersect",value:t.onIntersect,expression:"onIntersect"}],ref:"itemList",staticClass:"fill-block"}),a("v-text-field",{staticClass:"input-box ma-4 mr-8",attrs:{rounded:"",label:"键入命令",solo:"","hide-details":"",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onCommandSend(e)}},model:{value:t.inputCommand,callback:function(e){t.inputCommand=e},expression:"inputCommand"}}),a("v-fab-transition",[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.inputCommand&&t.inputCommand.length>0,expression:"inputCommand && inputCommand.length > 0"}],staticClass:"fab-btn",attrs:{color:"green",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:t.onCommandSend}},[a("v-icon",[t._v("mdi-arrow-right-thick")])],1)],1),a("v-fab-transition",[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.inputCommand||t.inputCommand.length<=0,expression:"!inputCommand || inputCommand.length <= 0"}],staticClass:"fab-btn",attrs:{color:"pink",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:function(e){t.commandListVisiable=!0}}},[a("v-icon",[t._v("mdi-code-braces")])],1)],1)],1),a("command-list",{attrs:{show:t.commandListVisiable},on:{"on-close":function(e){t.commandListVisiable=!1},"on-select":t.getCommand}}),a("boot",{attrs:{show:t.bootVisable},on:{"on-finish":t.onLoginSuccess}}),a("login",{attrs:{show:t.loginVisable},on:{"on-success":t.onLoginSuccess}})],1)},ge=[],ye=(a("99af"),a("0481"),a("a15b"),a("4069"),a("1276"),a("2909")),Ce=(a("d3b7"),a("25f0"),a("3ca3"),a("ddb0"),a("3835")),Oe=function(t){function e(){return Object(m["a"])(this,e),Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments))}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"initScreepsApi",value:function(t){var e=this,a=this.getPlayerInfo(t),n=this.initWebSocket();return Promise.all([a,n]).then((function(t){var a=Object(Ce["a"])(t,2),n=a[0],i=a[1];return e.playerInfo=n,e.authSessionToken(i,n.sessionToken)})).then((function(t){var a=t.ws,n=t.sessionToken;return console.log("准备就绪！",n,a),e.screepsWebSock=a,e.playerInfo.sessionToken=n,e.subscribeConsole(e.screepsWebSock,e.playerInfo.userId)}))}},{key:"initWebSocket",value:function(){var t=this;return new Promise((function(e,a){try{var n="wss://screeps.com/socket/".concat(t.getRandStr("number",3),"/").concat(t.getRandStr("string",8),"/websocket");console.log("TCL: ScreepsApi -> screepsUrl",n);var i=new WebSocket(n);i.onopen=function(){return e(i)},i.onerror=function(t){return a(t)}}catch(s){a(s)}}))}},{key:"getPlayerInfo",value:function(t){return new Promise((function(e,a){l("/api/auth/me",{},{"X-token":t}).then((function(t){200===t.status&&1===t.data.ok?e({username:t.data.username,userId:t.data._id,money:t.data.money,sessionToken:t.config.headers["X-token"]}):a(new Error(t.status.toString()))})).catch((function(t){return a(t)}))}))}},{key:"sendConsoleExpression",value:function(t,e){return u("/api/user/console",{expression:t,shard:e},{"X-token":this.playerInfo.sessionToken})}},{key:"authSessionToken",value:function(t,e){return new Promise((function(a,n){t.send('["auth '.concat(e,'"]')),t.onmessage=function(e){if("a"===e.data[0]){var i=JSON.parse(e.data.substring(1))[0];i.includes("auth ok")?a({ws:t,sessionToken:i.split(" ")[2]}):i.includes("auth failed")&&n(e)}}}))}},{key:"subscribeConsole",value:function(t,e){return new Promise((function(a){t.send('["subscribe user:'.concat(e,'/console"]')),console.log("已订阅控制台"),a(t)}))}},{key:"getSessionToken",value:function(t,e){return new Promise((function(a,n){u("/api/auth/signin",{email:t,password:e}).then((function(t){200===t.status&&1===t.data.ok?a(t.data.token):n(new Error(t.status.toString()))})).catch((function(t){return n(t)}))}))}},{key:"getRandStr",value:function(t,e){for(var a="number"===t?"0123456789":"abcdefghijklmnopqrstuvwxyz",n="",i=0;i<e;i++)n+=a.charAt(Math.floor(Math.random()*a.length));return n}},{key:"getDataInMessage",value:function(t){return"a"===t[0]||"m"===t[0]?JSON.parse(t.substr(1,t.length)):[""]}},{key:"closeWebSocket",value:function(){this.screepsWebSock&&this.screepsWebSock.close()}}]),e}(k["e"]);Oe=Object(f["a"])([k["a"]],Oe);var je=Oe,we=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-overlay",{attrs:{value:t.show}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",light:""}},[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[a("span",[t._v(t._s(t.currentTitle))])]),a("v-window",{model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-window-item",{attrs:{value:1}},[a("div",{staticClass:"pa-2 pt-0"},t._l(t.introduceContent,(function(e,n){return a("v-list-item",{key:n},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v(t._s(e.title))]),a("div",{staticClass:"content"},[t._v(t._s(e.text))])],1)],1)})),1)]),a("v-window-item",{attrs:{value:2}},[a("v-divider"),a("v-tabs",{staticClass:"mb-4",attrs:{"fixed-tabs":""},model:{value:t.loginTab,callback:function(e){t.loginTab=e},expression:"loginTab"}},[a("v-tab",[t._v("token")]),a("v-tab",[t._v("账号密码")])],1),a("v-tabs-items",{model:{value:t.loginTab,callback:function(e){t.loginTab=e},expression:"loginTab"}},[a("v-tab-item",{key:"token"},[a("v-card-text",{staticClass:"pt-0"},[a("v-text-field",{attrs:{label:"Screeps AuthToken","hide-details":""},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),a("div",{staticClass:"mt-5 caption grey--text text--darken-1"},[a("span",[t._v("token 将会被保存至本地以执行免验证登录。点击")]),a("a",{on:{click:function(e){return t.openPage(t.tokenCreateUrl)}}},[t._v(" 此处")]),a("span",[t._v(" 来生成您的 token。")])])],1)],1),a("v-tab-item",{key:"account"},[a("v-card-text",{staticClass:"pt-0"},[a("v-text-field",{attrs:{label:"Screeps 登陆邮箱","hide-details":""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),a("v-text-field",{staticClass:"mt-2",attrs:{label:"Screeps 登陆密码","hide-details":"","append-icon":t.passwordVisiable?"mdi-eye":"mdi-eye-off",type:t.passwordVisiable?"text":"password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.next(e)},"click:append":function(e){t.passwordVisiable=!t.passwordVisiable}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",{staticClass:"mt-5 caption grey--text text--darken-1"},[t._v("本应用不会记录您的任何身份信息，所以在退出应用后将需要重新登录。")])],1)],1)],1)],1),a("v-window-item",{attrs:{value:3}},[a("div",{staticClass:"pa-2 pt-0 text-center"},[a("v-list-item",[a("v-list-item-content",[a("div",{staticClass:"title mb-4"},[t._v("欢迎回来！")]),a("div",{staticClass:"subtitle-1"},[t._v("现在你可以直接与 Screeps 控制台进行交互，所有控制台输出也会直接反馈到本应用中。")]),a("div",{staticClass:"subtitle-1"},[t._v("同时你也可以自定义快捷命令来快速执行某些常用操作。点击左上角菜单来了解更多操作。")])])],1)],1)])],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{disabled:1===t.step,text:""},on:{click:function(e){t.step--}}},[t._v("上一步")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",depressed:"",loading:t.confirmBtnLoading},on:{click:t.next}},[t._v("确认")])],1)],1)],1)},Ve=[],xe=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.tokenCreateUrl="https://screeps.com/a/#!/account/auth-tokens",t.introduceContent=[{title:"数据",text:"本应用所有数据均保存在本地，自动或手动清除浏览器缓存将可能导致数据丢失（确保浏览器已退出无痕模式），请妥善使用导出 / 导入功能。"},{title:"网络",text:"本应用不会优化与 Screeps 的连接质量，在网络不好时可能会出现命令丢失等问题。"},{title:"开源",text:"本应用代码已开源至 github。更多信息请访问”关于“页。"}],t.loginTab=0,t.step=1,t.passwordVisiable=!1,t.token="",t.email="",t.password="",t.sessionToken="",t.confirmBtnLoading=!1,t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"finishBoot",value:function(){return T.init(),{token:this.sessionToken,type:0===this.loginTab?"token":"account"}}},{key:"next",value:function(){2===this.step?this.login():3===this.step?this.finishBoot():this.step++}},{key:"login",value:function(){this.confirmBtnLoading||(0===this.loginTab?this.tokenAuth():1===this.loginTab&&this.accountAuth())}},{key:"tokenAuth",value:function(){var t=this;this.token&&(this.confirmBtnLoading=!0,this.$toast.info("正在向 Screeps 服务器验证身份..."),this.getPlayerInfo(this.token).then((function(e){T.setToken(t.token),t.sessionToken=e.sessionToken,t.step++,t.$toast.success("验证成功，免登陆验证已启用"),t.confirmBtnLoading=!1})).catch((function(e){t.confirmBtnLoading=!1,t.$toast.error(e.message.includes("401")?"验证失败，请检查 token 是否正确":"验证失败, 错误信息如下: "+e.message)})))}},{key:"accountAuth",value:function(){var t=this;this.email&&this.password&&(this.confirmBtnLoading=!0,this.$toast.info("正在向 Screeps 服务器验证身份..."),this.getSessionToken(this.email,this.password).then((function(e){t.sessionToken=e,t.step++,t.$toast.success("验证成功"),t.confirmBtnLoading=!1})).catch((function(e){t.confirmBtnLoading=!1,t.$toast.error(e.message.includes("401")?"验证失败，请检查用户名密码是否正确":"验证失败, 错误信息如下: "+e.message)})))}},{key:"openPage",value:function(t){window.open(t)}},{key:"currentTitle",get:function(){switch(this.step){case 1:return"使用须知";case 2:return"账户确认";case 3:return"";default:return"初始化"}}}]),e}(Object(k["c"])(je));Object(f["a"])([Object(k["d"])()],xe.prototype,"show",void 0),Object(f["a"])([Object(k["b"])("on-finish")],xe.prototype,"finishBoot",null),xe=Object(f["a"])([k["a"]],xe);var _e=xe,Se=_e,Te=(a("e0ec"),a("a797")),Ie=a("71a3"),Le=a("c671"),Pe=a("fe57"),Be=a("aac8"),De=a("f665"),$e=a("1e6c"),Ne=Object($["a"])(Se,we,Ve,!1,null,"0581d97e",null),Ee=Ne.exports;E()(Ne,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardText:A["b"],VCardTitle:A["c"],VDivider:Q["a"],VListItem:W["a"],VListItemContent:J["a"],VListItemTitle:J["c"],VOverlay:Te["a"],VSpacer:Y["a"],VTab:Ie["a"],VTabItem:Le["a"],VTabs:Pe["a"],VTabsItems:Be["a"],VTextField:Z["a"],VWindow:De["a"],VWindowItem:$e["a"]});var Me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-overlay",{attrs:{value:t.show}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",light:""}},[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("身份认证")]),a("v-card-text",{staticClass:"px-2 pb-2"},[a("v-text-field",{staticClass:"ma-2",attrs:{label:"Screeps 登陆邮箱","hide-details":""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),a("v-text-field",{staticClass:"ma-2",attrs:{label:"Screeps 登陆密码","hide-details":"","append-icon":t.passwordVisiable?"mdi-eye":"mdi-eye-off",type:t.passwordVisiable?"text":"password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)},"click:append":function(e){t.passwordVisiable=!t.passwordVisiable}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",{staticClass:"ma-2 caption grey--text text--darken-1"},[t._v("本应用不会记录您的任何身份信息，所以在退出应用后将需要重新登录。")]),a("v-btn",{attrs:{color:"primary",block:"",depressed:"",loading:t.loading},on:{click:t.login}},[t._v("登陆")])],1)],1)],1)},Ae=[],Fe=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.passwordVisiable=!1,t.email="",t.password="",t.loading=!1,t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"login",value:function(){var t=this;""===this.email||""===this.password||this.loading||(this.loading=!0,this.$toast.info("正在向 Screeps 服务器验证身份..."),this.getSessionToken(this.email,this.password).then((function(e){t.loginSuccess(e)})).catch((function(){t.loading=!1,t.$toast.error("验证失败，请验证用户名密码是否正确")})))}},{key:"loginSuccess",value:function(t){return{token:t,type:"account"}}}]),e}(Object(k["c"])(je));Object(f["a"])([Object(k["d"])()],Fe.prototype,"show",void 0),Object(f["a"])([Object(k["b"])("on-success")],Fe.prototype,"loginSuccess",null),Fe=Object(f["a"])([k["a"]],Fe);var We=Fe,Je=We,qe=(a("f469"),Object($["a"])(Je,Me,Ae,!1,null,"91c570b0",null)),Ge=qe.exports;E()(qe,{VBtn:K["a"],VCard:M["a"],VCardText:A["b"],VCardTitle:A["c"],VOverlay:Te["a"],VTextField:Z["a"]});var Re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"console-item-contaienr"},[a("v-list-item",{attrs:{ripple:!1}},[a("v-list-item-icon",{staticClass:"my-3 mr-4"},[a("v-btn",{attrs:{icon:"",small:"",loading:t.loading},on:{click:t.copyContent}},[a("v-icon",{attrs:{color:t.iconColor}},[t._v(t._s(t.icon))])],1)],1),a("v-list-item-content",{on:{click:t.onContentClick}},[a("div",{ref:"content",staticClass:"body-2"},t._l(t.content,(function(t){return a("div",{staticClass:"my-2"})})),0)])],1),a("v-divider")],1)},He=[],Ue=function(t){function e(){return Object(m["a"])(this,e),Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments))}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"refrashContent",value:function(t){for(var e=this.$refs.content,a=0;a<e.children.length;a++)e.children[a].innerHTML=t[a]}},{key:"onContentClick",value:function(){}},{key:"copyContent",value:function(){return this.content}},{key:"mounted",value:function(){this.refrashContent(this.content)}},{key:"iconColor",get:function(){return"mdi-arrow-bottom-right-thick"===this.icon?"amber":"mdi-arrow-top-left-thick"===this.icon?"light-blue":"mdi-alert-circle"===this.icon?"error":"light-green"}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])({required:!0})],Ue.prototype,"content",void 0),Object(f["a"])([Object(k["d"])({required:!0})],Ue.prototype,"icon",void 0),Object(f["a"])([Object(k["d"])({default:!0})],Ue.prototype,"loading",void 0),Object(f["a"])([Object(k["f"])("content")],Ue.prototype,"refrashContent",null),Object(f["a"])([Object(k["b"])("on-item-click")],Ue.prototype,"onContentClick",null),Object(f["a"])([Object(k["b"])("on-icon-click")],Ue.prototype,"copyContent",null),Ue=Object(f["a"])([k["a"]],Ue);var Xe=Ue,ze=Xe,Ke=Object($["a"])(ze,Re,He,!1,null,null,null),Qe=Ke.exports;E()(Ke,{VBtn:K["a"],VDivider:Q["a"],VIcon:ot["a"],VListItem:W["a"],VListItemContent:J["a"],VListItemIcon:ne["a"]});var Ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-bottom-sheet",{on:{"click:outside":t.close},model:{value:t.sheetVisiable,callback:function(e){t.sheetVisiable=e},expression:"sheetVisiable"}},[a("v-list",t._l(t.commandListData,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("v-list-item",{on:{click:function(a){return t.onCommandClick(e)}}},[a("v-chip",{staticClass:"mr-3",attrs:{small:"",disabled:""}},[t._v(t._s(e.shard||"全局"))]),a("span",{staticClass:"d-inline-block text-truncate text-no-wrap"},[t._v(t._s(e.title))])],1),n!=t.commandListData.length-1?a("v-divider"):t._e()],1)})),0),a("parameter-collecter",{attrs:{show:t.parameterCollecterVisiable},on:{"on-close":t.onParamClose,"on-finish":t.onParamFinish},model:{value:t.collectingParam,callback:function(e){t.collectingParam=e},expression:"collectingParam"}})],1)},Ze=[],ta=(a("4d63"),a("5319"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("请填写参数")]),t._l(t.paramInputs,(function(e,n){return a("div",{key:n,staticClass:"mx-2 px-2"},[a("v-text-field",{staticClass:"mb-4",attrs:{label:e.label,"hide-details":"",clearable:""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)})),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{width:"100"},on:{click:t.close}},[t._v("放弃")]),a("v-spacer"),a("v-btn",{attrs:{width:"100",color:"primary",depressed:""},on:{click:t.returnParam}},[t._v("确认")])],1)],2)],1)}),ea=[],aa=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.show=!1,t.paramInputs=[],t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"loadDefaultValue",value:function(t){t&&(this.paramInputs=this.value.map((function(t){return Object(C["a"])({},t,{value:t.default})})))}},{key:"close",value:function(){}},{key:"returnParam",value:function(){return this.paramInputs.map((function(t){return{match:t.match,value:t.value}}))}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])({required:!0,default:[]})],aa.prototype,"value",void 0),Object(f["a"])([Object(k["d"])({required:!0})],aa.prototype,"show",void 0),Object(f["a"])([Object(k["f"])("show")],aa.prototype,"loadDefaultValue",null),Object(f["a"])([Object(k["b"])("on-close")],aa.prototype,"close",null),Object(f["a"])([Object(k["b"])("on-finish")],aa.prototype,"returnParam",null),aa=Object(f["a"])([k["a"]],aa);var na=aa,ia=na,sa=Object($["a"])(ia,ta,ea,!1,null,"1ffb6b68",null),oa=sa.exports;E()(sa,{VBtn:K["a"],VCard:M["a"],VCardActions:A["a"],VCardTitle:A["c"],VDialog:F["a"],VDivider:Q["a"],VSpacer:Y["a"],VTextField:Z["a"]});var ca=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.sheetVisiable=!1,t.commandListData=[],t.parameterCollecterVisiable=!1,t.collectingParam=[],t.selectCommand="",t.selectShard="",t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"updateData",value:function(t){this.sheetVisiable=t,t&&(this.commandListData=T.get().commands)}},{key:"onCommandClick",value:function(t){this.selectCommand=t.body,this.selectShard=t.shard,t.param.length>0?(this.collectingParam=t.param,this.parameterCollecterVisiable=!0):this.sendCommand(t.body)}},{key:"sendCommand",value:function(t){return this.selectShard||(this.selectShard=T.get().shard),{command:t,shard:this.selectShard}}},{key:"close",value:function(){}},{key:"onParamClose",value:function(){this.parameterCollecterVisiable=!1}},{key:"onParamFinish",value:function(t){this.parameterCollecterVisiable=!1;var e=this.buildCommand(this.selectCommand,t);this.sendCommand(e)}},{key:"buildCommand",value:function(t,e){var a=t;return e.map((function(t){a=a.replace(new RegExp("\\".concat(t.match),"g"),t.value)})),a}}]),e}(k["e"]);Object(f["a"])([Object(k["d"])({required:!0,default:!1})],ca.prototype,"show",void 0),Object(f["a"])([Object(k["f"])("show")],ca.prototype,"updateData",null),Object(f["a"])([Object(k["b"])("on-select")],ca.prototype,"sendCommand",null),Object(f["a"])([Object(k["b"])("on-close")],ca.prototype,"close",null),ca=Object(f["a"])([Object(k["a"])({components:{ParameterCollecter:oa}})],ca);var ra=ca,la=ra,ua=a("288c"),da=a("cc20"),va=Object($["a"])(la,Ye,Ze,!1,null,"5c9daca9",null),ma=va.exports;E()(va,{VBottomSheet:ua["a"],VChip:da["a"],VDivider:Q["a"],VList:pt["a"],VListItem:W["a"]});var ba=function(t){function e(){var t;return Object(m["a"])(this,e),t=Object(b["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.messageList=[],t.commandListVisiable=!1,t.inputCommand="",t.screepsToken="",t.bootVisable=!1,t.loginVisable=!1,t.fillBlockVisiable=!1,t}return Object(h["a"])(e,t),Object(O["a"])(e,[{key:"pasteMessage",value:function(t){this.inputCommand=t.join("\n")}},{key:"onCommandSend",value:function(){this.sendCommand(this.inputCommand,T.get().shard),this.inputCommand=""}},{key:"sendCommand",value:function(t,e){var a=this;if(t&&!(t.length<=0)){var n=this.addNewMessage([t],"mdi-arrow-top-left-thick",!0,e);this.sendConsoleExpression(t,e).then((function(t){console.log("命令发送完成",t),n.loading=!1,t.data.error&&(n.icon="mdi-alert-circle",a.addNewMessage(["发送失败: "+t.data.error],"mdi-alert-circle",!1,e))})).catch((function(t){n.loading=!1,n.icon="mdi-alert-circle",a.addNewMessage(["啊哦，命令发送失败，请尝试刷新网页并重新登陆",t],"mdi-alert-circle",!1,e)})),this.scrollToBottom()}}},{key:"onIntersect",value:function(t){this.fillBlockVisiable=t[0].isIntersecting}},{key:"scrollToBottom",value:function(){console.log("Console -> scrollToBottom -> this.$refs.itemList",this.$refs.itemList),this.$vuetify.goTo(this.$refs.itemList,{duration:1e3})}},{key:"getCommand",value:function(t){this.commandListVisiable=!1,this.sendCommand(t.command,t.shard)}},{key:"onMessage",value:function(t){if("a"===t.data[0]){try{var e=JSON.parse(t.data.substring(1))[0],a=JSON.parse(e)[1],n=[];if(a.error)this.addNewMessage(a.error.split("\n"),"mdi-alert-circle",!1,a.shard);else{if(a.messages.log.length>0&&n.push.apply(n,Object(ye["a"])(a.messages.log.map((function(t){return t.split("\n")})).flat())),a.messages.results.length>0&&n.push.apply(n,Object(ye["a"])(a.messages.results[0].split("\n"))),n.length<=0)return;this.addNewMessage(n,"mdi-arrow-bottom-right-thick",!1,a.shard)}}catch(i){console.log("onMessage 数据解析出错",i,t)}this.fillBlockVisiable&&this.scrollToBottom()}}},{key:"addNewMessage",value:function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=new Date,s={content:t,icon:e,loading:a,shard:n,date:"".concat(i.getHours(),":").concat(i.getMinutes(),":").concat(i.getSeconds())};return this.messageList.push(s),s}},{key:"onLoginSuccess",value:function(t){this.bootVisable=!1,this.loginVisable=!1,this.addNewMessage(["token"===t.type?"发现 AuthToken，跳过登录验证":"登录成功"],"mdi-key",!1);var e=this.addNewMessage(["正在订阅 Screeps WebSocket, 请稍后..."],"mdi-wifi");this.screepsToken=t.token,this.createSocket(t.token,e)}},{key:"createSocket",value:function(t,e){var a=this;this.initScreepsApi(t).then((function(t){t.onmessage=a.onMessage,e.loading=!1,e.content=["Screeps WebSocket 订阅成功!"],a.addNewMessage(["您现在可以正常与控制台进行交互"],"mdi-wifi",!1),a.keepSockTimer=setInterval(a.checkSockAlive,1e3)})).catch((function(t){console.log("该死，初始化 ws 出错了!",t),e.loading=!1,e.icon="mdi-alert-circle",e.content=["Screeps WebSocket 订阅失败, 请刷新重试"],t.message.includes("401")&&a.addNewMessage(["当前登录信息已过期，请检查 token 或账号密码是否正确"],"mdi-alert-circle",!1)}))}},{key:"onItemClick",value:function(t){var e=t.shard?"所处镜面 ".concat(t.shard," | "):"";this.$toast.info("".concat(e,"消息时间 ").concat(t.date),{y:"top"})}},{key:"mounted",value:function(){if(T.exist){T.init();var t=T.get().token;t?this.onLoginSuccess({token:t,type:"token"}):this.loginVisable=!0}else this.bootVisable=!0}},{key:"checkSockAlive",value:function(){if(!document.hidden&&this.screepsWebSock){var t=this.screepsWebSock.readyState;2!==t&&3!==t||this.reloadSocket()}}},{key:"reloadSocket",value:function(){var t=this.addNewMessage(["连接已断开，正在重新订阅..."],"mdi-wifi");this.createSocket(this.screepsToken,t),clearInterval(this.keepSockTimer)}},{key:"destroyed",value:function(){this.closeWebSocket()}}]),e}(Object(k["c"])(je));ba=Object(f["a"])([Object(k["a"])({components:{ConsoleItem:Qe,CommandList:ma,Boot:Ee,Login:Ge}})],ba);var pa=ba,ha=pa,fa=(a("0247"),a("0789")),ka=a("1baa"),ga=a("269a"),ya=a.n(ga),Ca=a("90a2"),Oa=Object($["a"])(ha,ke,ge,!1,null,"2c398640",null),ja=Oa.exports;E()(Oa,{VBtn:K["a"],VFabTransition:fa["c"],VIcon:ot["a"],VList:pt["a"],VListItemGroup:ka["a"],VTextField:Z["a"]}),ya()(Oa,{Intersect:Ca["a"]}),n["a"].use(fe["a"]);var wa=[{path:"/",redirect:"/console"},{path:"/console",component:ja}],Va=new fe["a"]({routes:wa}),xa=a("f309"),_a=a("2db4"),Sa=a("87f6"),Ta=a.n(Sa);n["a"].use(xa["a"],{components:{VSnackbar:_a["a"],VBtn:K["a"],VIcon:ot["a"]}}),n["a"].use(Ta.a,{x:"center",showClose:!0,closeIcon:"mdi-close",closeColor:"white"});var Ia=new xa["a"]({}),La=a("4eb5"),Pa=a.n(La);Pa.a.config.autoSetContainer=!0,n["a"].use(Pa.a),n["a"].config.productionTip=!1,new n["a"]({router:Va,vuetify:Ia,render:function(t){return t(he)}}).$mount("#app")},e0ec:function(t,e,a){"use strict";var n=a("38e1"),i=a.n(n);i.a},f469:function(t,e,a){"use strict";var n=a("85b0"),i=a.n(n);i.a}});
//# sourceMappingURL=app.5f7254a3.js.map